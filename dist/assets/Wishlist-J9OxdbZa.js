import{g as N,b as B,r as p,d as M,_ as k,e as D,j as e,s as q,f as G,T as C,h as _,i as H,p as U,q as K,u as O,A as V,G as J,E as z,v as S,K as Q,B as y,R as X,D as i,C as Y,P as r,W as Z,a2 as ee,aK as te,a as A,aI as se,t as F,w as ne,I as ae,z as ie,bk as re}from"./index-3lHyeO3h.js";import{d as oe}from"./CheckCircle-Ds_GUTbA.js";import{C as L}from"./Modal-CauVSvi-.js";import{u as le,d as ce,S as E,T as $}from"./TextField-huRVlyVb.js";import{D as de,a as ue,b as pe}from"./DialogTitle-s6GMgmtk.js";import{D as xe}from"./DialogActions-Bj04cvSd.js";function me(s){return B("MuiInputAdornment",s)}const W=N("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var R;const he=["children","className","component","disablePointerEvents","disableTypography","position","variant"],ge=(s,n)=>{const{ownerState:o}=s;return[n.root,n[`position${_(o.position)}`],o.disablePointerEvents===!0&&n.disablePointerEvents,n[o.variant]]},fe=s=>{const{classes:n,disablePointerEvents:o,hiddenLabel:c,position:d,size:x,variant:f}=s,v={root:["root",o&&"disablePointerEvents",d&&`position${_(d)}`,f,c&&"hiddenLabel",x&&`size${_(x)}`]};return H(v,me,n)},ve=q("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:ge})(({theme:s,ownerState:n})=>D({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(s.vars||s).palette.action.active},n.variant==="filled"&&{[`&.${W.positionStart}&:not(.${W.hiddenLabel})`]:{marginTop:16}},n.position==="start"&&{marginRight:8},n.position==="end"&&{marginLeft:8},n.disablePointerEvents===!0&&{pointerEvents:"none"})),be=p.forwardRef(function(n,o){const c=M({props:n,name:"MuiInputAdornment"}),{children:d,className:x,component:f="div",disablePointerEvents:v=!1,disableTypography:g=!1,position:a,variant:m}=c,P=k(c,he),h=le()||{};let l=m;m&&h.variant,h&&!l&&(l=h.variant);const t=D({},c,{hiddenLabel:h.hiddenLabel,size:h.size,disablePointerEvents:v,position:a,variant:l}),u=fe(t);return e.jsx(ce.Provider,{value:null,children:e.jsx(ve,D({as:f,ownerState:t,className:G(u.root,x),ref:o},P,{children:typeof d=="string"&&!g?e.jsx(C,{color:"text.secondary",children:d}):e.jsxs(p.Fragment,{children:[a==="start"?R||(R=e.jsx("span",{className:"notranslate",children:"​"})):null,d]})}))})});var w={},je=U;Object.defineProperty(w,"__esModule",{value:!0});var T=w.default=void 0,ye=je(K()),Ce=e;T=w.default=(0,ye.default)((0,Ce.jsx)("path",{d:"m19.83 7.5-2.27-2.27c.07-.42.18-.81.32-1.15.08-.18.12-.37.12-.58 0-.83-.67-1.5-1.5-1.5-1.64 0-3.09.79-4 2h-5C4.46 4 2 6.46 2 9.5S4.5 21 4.5 21H10v-2h2v2h5.5l1.68-5.59 2.82-.94V7.5zM13 9H8V7h5zm3 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Savings");function _e(){const{currentUser:s}=O(),[n,o]=p.useState(!0),[c,d]=p.useState([]),[x,f]=p.useState({limit:0,spent:0}),[v,g]=p.useState(!1),[a,m]=p.useState({name:"",price:"",priority:"medium"});p.useEffect(()=>{if(!s)return;const t=V(z(S,`users/${s.uid}/wishlist`),J("createdAt","desc")),u=Q(t,b=>{const j=b.docs.map(I=>({id:I.id,...I.data(),price:parseFloat(I.data().price)||parseFloat(I.data().estimatedCost)||0}));d(j),o(!1)});return(async()=>{try{const b=F(S,`users/${s.uid}/settings/budget`),j=await ne(b);j.exists()&&f({limit:j.data().monthlyLimit||0,spent:j.data().currentSpent||0})}catch(b){console.error(b)}})(),()=>u()},[s]);const P=async()=>{if(a.name)try{await ae(z(S,`users/${s.uid}/wishlist`),{name:a.name,price:parseFloat(a.price)||0,priority:a.priority,createdAt:ie()}),g(!1),m({name:"",price:"",priority:"medium"})}catch(t){console.error(t)}},h=async t=>{window.confirm("Löschen?")&&await re(F(S,`users/${s.uid}/wishlist`,t))},l=x.limit-x.spent;return n?e.jsx(y,{sx:{display:"flex",justifyContent:"center",mt:10},children:e.jsx(X,{})}):e.jsx(y,{sx:i.bottomNavSpacer,children:e.jsxs(Y,{maxWidth:"sm",sx:{pt:2},children:[e.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(C,{variant:"h4",sx:i.textGradient,children:"Wishlist"}),e.jsx(L,{icon:e.jsx(T,{}),label:`${l.toFixed(2)} €`,sx:{bgcolor:l>0?`${r.accents.green}22`:`${r.accents.red}22`,color:l>0?r.accents.green:r.accents.red,border:`1px solid ${l>0?r.accents.green:r.accents.red}`}})]}),e.jsx(E,{spacing:2,children:c.length===0?e.jsx(C,{variant:"body1",color:"text.secondary",align:"center",sx:{mt:5},children:"Leer."}):c.map(t=>{const u=l>=t.price;return e.jsx(Z,{sx:{p:2,...i.glassCard,borderLeft:u?`4px solid ${r.accents.green}`:"4px solid transparent",opacity:u?1:.7},children:e.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(y,{children:[e.jsx(C,{variant:"subtitle1",sx:{fontWeight:"bold"},children:t.name}),e.jsxs(E,{direction:"row",spacing:1,sx:{mt:.5,alignItems:"center"},children:[e.jsx(L,{label:`${t.price.toFixed(2)} €`,size:"small",sx:u?{bgcolor:r.accents.green,color:"black",fontWeight:"bold"}:i.chip.default}),u&&e.jsxs(C,{variant:"caption",sx:{color:r.accents.green,display:"flex",alignItems:"center",gap:.5},children:[e.jsx(oe,{fontSize:"inherit"})," Machbar"]})]})]}),e.jsx(ee,{size:"small",onClick:()=>h(t.id),sx:{color:r.accents.red},children:e.jsx(te,{})})]})},t.id)})}),e.jsx(A,{variant:"contained",size:"large",startIcon:e.jsx(se,{}),onClick:()=>g(!0),sx:{position:"fixed",bottom:90,right:20,borderRadius:8,px:3,...i.buttonGradient},children:"Wunsch"}),e.jsxs(de,{open:v,onClose:()=>g(!1),PaperProps:i.dialog.paper,fullWidth:!0,children:[e.jsx(ue,{sx:i.dialog.title.sx,children:"Neuer Wunsch"}),e.jsx(pe,{sx:i.dialog.content.sx,children:e.jsxs(E,{spacing:2,sx:{mt:1},children:[e.jsx($,{label:"Name",fullWidth:!0,autoFocus:!0,value:a.name,onChange:t=>m({...a,name:t.target.value}),sx:i.inputField}),e.jsx($,{label:"Preis",type:"number",fullWidth:!0,InputProps:{startAdornment:e.jsx(be,{position:"start",children:"€"})},value:a.price,onChange:t=>m({...a,price:t.target.value}),sx:i.inputField}),e.jsxs($,{select:!0,label:"Priorität",fullWidth:!0,SelectProps:{native:!0},value:a.priority,onChange:t=>m({...a,priority:t.target.value}),sx:i.inputField,children:[e.jsx("option",{value:"high",children:"Hoch"}),e.jsx("option",{value:"medium",children:"Mittel"}),e.jsx("option",{value:"low",children:"Niedrig"})]})]})}),e.jsxs(xe,{sx:i.dialog.actions.sx,children:[e.jsx(A,{onClick:()=>g(!1),color:"inherit",children:"Abbrechen"}),e.jsx(A,{onClick:P,variant:"contained",disabled:!a.name,sx:i.buttonGradient,children:"Hinzufügen"})]})]})]})})}export{_e as default};
